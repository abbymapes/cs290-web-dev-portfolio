<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="author" content="Abby Mapes">
    <title>CompSci 290, Spring 2021 : Final Progress Report 2</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://unpkg.com/bootstrap/dist/css/bootstrap.css" />
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css" />
    <script src="https://unpkg.com/vue"></script>

    <link rel="stylesheet" href="../../style.css">
</head>

<body>
    <div id="content">
        <div class="nav-bar">
            <a href="../../index.html" class="home">Home</a>
            <a href="../../interests/index.html">Interests</a>
            <a href="../../projectList.html">Course Deliverables</a>
        </div>

        <header>
            <h1>Final Progress Report 2</h1>
        </header>

        <div class="text-section center">
            <h2>Demo</h2>
            <a href="https://drive.google.com/file/d/1hfIeyVBFRwnROaC9x4DfP1XNMj6dN0fO/view?usp=sharing/">Here</a> is a
            link to my second demo video.
            <br>
            <a href="https://tranquil-hollows-68915.herokuapp.com/">Here</a> the example data from my server that I've pulled from Firestore and sent to the front-end for this demo.
            I used for this demo.
            <br>
            <br>
            <h2>Data</h2>
            <p>
                Here is an overview of the data I will use for my app, and how my data structures, collections, and
                plans have changed since the last demo:
                <br>
                <br>
                <b>Class Data</b>
                <br>
                Since the last demo, my class data remains pretty much the same. I am still using data from the Duke
                Curriculum API, which provides JSON streams of data that contain various course details, that I have
                loaded into the Firebase. I decided to do so because the Duke Curriculum API was very slow when fetching
                information for multiple classes at a time. In Firebase, I’ve stored the following fields from the API
                for each course: catalogNumber, courseCodes, courseId, description, offerNumber, subjectCode,
                subjectName, title, and type. Each courseId was chosen from the courseId given via Duke’s Catalog API,
                which the documentation specified were all unique. So, I used this courseId as the id for each document
                in Firebase. As I touched on in my last report, I planned to add some of my own fields, including a
                count of “interesting” ratings and a sum of “interesting” ratings that will allow me to calculate an
                average “interesting” rating for each course– based on user inputted ratings. However, in developing my
                site over this past week, I’ve realized that I want to store rating information for each user. This will
                allow me to store their past ratings for each course, so that they can change their ratings (rather than
                continue submitting ratings over and over again). In doing so, I found it easier to sum over all the
                ratings and counts for a course within the ratings collection to calculate the averages. This allows the
                data to remain dynamic and causes less confusion with people adding / removing ratings (and what the
                course data should do for ratings of 0, etc). <a href="./exampleClassData.json">Here</a> is the JSON
                data structure I will use for each
                course. Note, each property represents a field for documents in the course collection in Firebase, which
                I have already initiated for each course. If any of these fields were missing (i.e. a course didn’t have
                a course code), then I initialized them to an empty version of the data type (i.e. an empty string,
                array, or the number 0).
                <br>
                <br>
                <b>User Data</b>
                <br>
                In order to display user profiles, I am storing the following information for each user: userId,
                displayName, email, picture, majors, minors, certificates, subjects. Each userId will be generated by
                Firebase, so it will be unique. In this demo, I create a small synthetic database of documents with
                certain ids that made it easier for me to develop with (i.e. “testId”). However, after developing, I
                will use Firebase’s randomly generated id for each user document. The information for each user will all
                be inputted by the user when creating their profile, or by liking subjects when interacting with
                Bluebook. <a href="./exampleUserData.json">Here</a> is the JSON data structure I will use for each user.
                Note, each property represents a field for documents in the course collection in Firebase, which I have
                already initiated for a small synthetic set of users. If any of these fields were missing (i.e. a user
                doesn’t have a minor), then I initialized them to an empty version of the data type (i.e. an empty
                string, array, or the number 0).
                <br>
                <br>
                <b>Reaction Data</b>
                <br>
                In order to store user reactions to different class, I am storing the following information for each
                time a user reacts to a class (by either liking, disliking, or adding the class to their wishlist):
                userId, courseId, reactionId, date, dislike (boolean), like (boolean), wishlist (boolean). For
                reactions, I want to ensure that users can only have a single reaction for a class (i.e. they can’t like
                and dislike, wish and dislike, etc). So, I made the reactionId for each document equal to the
                concatenation of the userId and the courseId. Therefore, each user can only react once to each course.
                So, when a user (with userId = abby) clicks the “like” button for a class (with courseId = 123), we can
                set the “abby123” document in Firebase with the current date, userId, courseId, reactionId, and set like
                = true, dislike = false, wishlist = false. If any existing documents for “abby123” exist, then user
                “abby” has already reacted to this class. In this case, Firebase will override this document with the
                new reaction. Otherwise, if this document doesn’t exist, Firebase will create a new document.
                Additionally, by the way I’ve designed my code, only 1 of “like”, “dislike”, and “wishlist” will be set
                to true whenever a user reacts to a class (either updating their reaction or making a new reaction). By
                implementing the reactions this way, I ensured that no user can react twice to a class. However, when
                the user changes their reaction to a class, I have to remove all existing comments with that reactionId
                from the comments collection to ensure that the new reaction will start fresh. <a
                    href="./exampleReactionData.json">Here</a> is the JSON data structure I will use for each reaction.
                Note, each property represents a field for documents in the reaction collection in Firebase, which I
                have already initiated for a small synthetic set of reactions. For these documents, no reaction
                documents can be missing any of these fields, which I’ve ensured by design of my web app.
                <br>
                <br>
                <b>Follows Data</b>
                <br>
                For each user, I am storing following information in order to retrieve a list of a user’s friends and
                the class reactions that will fill their feed. For each following relationship (i.e. when someone clicks
                “Add Friend” on another user’s profile), I store the followerId and the followingId, which correspond to
                the user Id of person A following the userId of person B. The ID for each document in the follows
                collection will be generated by Firebase. Since I only query by followerId or followingId, I don’t need
                to store this followId in the document itself. This data will be entered by users when they follow or
                unfollow each other. <a href="./exampleFollowsData.json">Here</a> is the JSON data structure I will use
                for each following relationship. Note,
                each property represents a field for documents in the follows collection in Firebase, which I have
                already initiated for a small synthetic set of following relationships. For these documents, no
                documents can be missing any of these fields, which I’ve ensured by design of my web app.
                <br>
                <br>
                <b>Comment Data</b>
                <br>
                For each comment made on a reaction post or a course page, I am storing the following information for
                each comment: reactionId or courseId, userId, commentText, date. This data will be entered by users when
                they post comments on other people’s reaction posts or on a course page. Each comment document will have
                a random id generated by Firebase. Note, each comment will either have a reactionId or a courseId, but
                not both properties. This allows me to query based on reactionId or courseId to retrieve comments for
                reactions and courses respectively. <a href="./exampleCommentData.json">Here</a> is the JSON data
                structure I will use for each comment. Note,
                each property represents a field for documents in the comments collection in Firebase, which I have
                already initiated for a small synthetic set of comments for both courses and reactions. For these
                documents, no documents can be missing any of these fields (besides one of courseId and reactionId),
                which I’ve ensured by design of my web app.
                <br>
                <br>
                <b>Subjects Data</b>
                <br>
                For each subject that the courses from Duke’s Catalog API were listed under, I stored a document
                containing a code and name property in Firestore. Since subject codes are unique, I made the subject
                code the id for each document in Firebase. This allows me to fetch names for subjects based on their
                subject codes from a user’s list of subjects or a course’s subjectCode data. <a
                    href="./exampleSubjectData.json">Here</a> is the JSON data
                structure I will use for each subject. Note, each property represents a field for documents in the
                subjects collection in Firebase, which I have already initiated with the full list of subjects from
                Duke’s API. For these documents, no documents can be missing either of these fields.
                <br>
                <br>
                <b>Ratings Data</b>
                <br>
                For each rating made for a course (i.e. when a user rates a course’s difficulty or interesting level on
                the course page), I am storing the following information: userId, courseId, difficulty (number),
                interesting (number). For ratings, similar to reactions, I want to ensure that users can only have a
                single rating for a class (i.e. they can’t rate a class multiple times). So, I made the id for each
                rating document equal to the concatenation of the userId and the courseId. So, when a user (with userId
                = abby) rates a class (with courseId = 123)– either by choosing a difficulty level or a interesting
                level–, we set the “abby123” rating document in Firebase with the userId, courseId, current interesting
                level, and current difficulty level. If any existing rating documents for “abby123” exist, then user
                “abby” has already rated this class. In this case, Firebase will override this document with the new
                rating. Otherwise, if this document doesn’t exist, Firebase will create a new document. In doing this,
                for each course, we are able to pull all rating documents with a courseId equal to that course and do
                the following: if the interesting property is not 0, we increment the interesting sum and count by 1.
                Likewise, if the difficulty property is not 0, we increment the difficulty sum and count by 1. Then, we
                can return the averages of these sums and counts for each course when a user clicks on the course page.
                This ensures that the ratings for each course are always accurate with the ratings stored in the
                database. <a href="./exampleRatingData.json">Here</a> is the JSON data structure I will use for each
                rating. Note, each property represents a
                field for documents in the rating collection in Firebase, which I have already initiated for a small
                synthetic set of ratings. For these documents, if the difficulty or interesting rating for the course is
                unrated by the user (i.e. if the user rated the interesting level, but not the difficulty level), then
                the unrated properties will be set to 0.
                <br>
                <br>
            <h2>Progress</h2>
                <h3>Planned Progress Before This Week</h3>
                Below are the features that I planned to have done before this week’s demo:
            <ul>
                <li>
                    <b>Set up Firestore database</b>: I have completed this (in the previous demo).
                </li>
                <li>
                    <b>Set Log In & Sign Up Pages</b>: As I touched on in my demo from last week, I decided to implement
                    the log in and sign up pages after I develop most of the functionality of the app itself, as it will
                    make it easier to access all pages during development (and manipulate my current user ID). I have
                    decided not to use OAuth, since I want to require users to log in with their Duke email address. So,
                    I will use Firebase's Authentication instead to ensure each user has a Duke email.
                </li>
                <li>
                    <b>Create Navigation Bar</b>: I have completed this (in the previous demo).
                </li>
                <li>
                    Create components with small synthetic dataset
                    <ul>
                        <li>
                            <b>Class Component: </b> I have completed this (in the previous demo).
                        </li>
                        <li>
                            <b>User Component: </b> I have completed this (in the previous demo).
                        </li>
                        <li>
                            <b>Reaction Component: </b> This week, I have set up a fully functioning reaction component.
                            This is described in detail below (for this week’s progress).
                        </li>
                    </ul>
                </li>
                <li>
                    Set up pages, but don’t need to implement reactivity / connecting to database yet
                    <ul>
                        <li>
                            <b>Set up class page</b>: This week, I have set up a fully functioning class page. This is
                            described in detail below (for this week’s progress).
                        </li>
                        <li>
                            <b>Set up course code page and subject page</b>: This week, I have set up fully functioning
                            course code and subject pages. This is described in detail below (for this week’s progress).
                        </li>
                        <li>
                            <b>Set up User page</b>: I have completed this (in the previous demo).
                        </li>
                        <li>
                            <b>Set up Feed page</b>: This week, I have set up fully functioning course code and subject
                            pages. This is described in detail below (for this week’s progress).
                        </li>
                    </ul>
                </li>
                <li>
                    <b>Test all above features on small synthetic dataset (inputted by me)</b>: I have completed this
                    with a small synthetic dataset made from JavaScript objects (in the previous demo).
                </li>
            </ul>
                <h3>Planned Progress For This Week</h3>
                Below are the features that I planned to have done for this week's demo (that I finished this week, along with the features above that I hadn't gotten to yet):
                <br>
                <br>
            <ul>
                <li>
                    <b>Load data from Firestore, rather than from hard coded data</b>: This week, I’ve set up fully
                    connectivity to Firestore for data, rather than using a Javascript synthetic data set. In doing so,
                    I’ve loaded and stored information in Firebase, making each page I’ve set up so far be fully
                    functioning and connected to the database.
                </li>
                <li>
                    <b>Set up the reaction component</b>: This week, I set up a fully functioning reaction component
                    that is used both in the feed page and in the reaction modal that appears when a course in a user’s
                    profile is clicked on (i.e. their reaction to that course appears in the modal). Within the reaction
                    component, I’ve implemented full functionality that allows users to click on the course name (which
                    takes them to that course page) or click on the users in the comment section or the user of the
                    reaction (which takes them to that user page). Additionally, I’ve implemented comment functionality
                    that allows users to post comments (which are stored in Firestore) and delete their own comments
                    (which deletes the comment document from Firestore).
                </li>
                <li>
                    <b>Set up the class page</b>: This week, I set up a fully functioning class page that displays
                    information about each class from Firestore (including title, description, ratings, comments, and
                    course codes). Additionally, I’ve connected each component on this page to the database, allowing
                    users to post comments for courses, delete their own comments, rate the difficulty / interesting
                    level (or change their previous rating), and react to the course (and display buttons based on their
                    current reactions). In doing so, the appropriate documents are written to Firebase with the
                    appropriate data (including comments, ratings, and reactions documents). Additionally, clicking on
                    the course attributes redirects the user to the appropriate attribute page and clicking on any users
                    on the page directs them to the appropriate user page.
                </li>
                <li>
                    <b>Set up feed page</b>: This week, I set up a fully functioning feed page that pulls reactions made
                    by the current user’s “friends” (such that the appropriate document exists in the follows
                    collection). These reaction components are sorted in descending order. Within each reaction, users
                    can comment on their friends' reactions and navigate to the course page or user page for that
                    reaction.
                </li>
                <li>
                    <b>Set up subject and course code page</b>: This week, I set up fully functioning subject and course
                    code pages that display Class components for classes in the database that match the specified
                    subject or contain the specified course code. Clicking on these classes takes the user to the course
                    page, where they can interact with the class. For the subject page, I’ve implemented the “add to
                    profile” button that allows users to add a class to their profile (or remove the class if it's
                    already in their profile). This will add this page to their user section.
                </li>
            </ul>
            <br>
            <br>
            <h2>Concerns</h2>
            <p>
                So far, I made a lot more progress this week on the project. However, it is taking a lot of time. I am a
                little concerned about the requirement for the “administrator” role aspect of the project. I’m not
                really sure where to begin with this and since we haven’t talked about it in class, I’m nervous that,
                along with the testing requirements, will take me a long time to fit in at the end of this class.
            </p>
            <br>
            <br>
            <h2>Learning</h2>
            <p>
                This week, I’ve learned a lot more about Promises. While we talked about it in class, I hadn’t had that
                much experience beyond merely using “async” and “await” in my code. However, when making nested calls to
                Firestore (i.e. for each user in the follows collection, get their name and display picture from the
                users collection), I’ve had to use Promise.all() and research more about waiting for a chain of promises
                to finish. This had always been something I didn’t understand, so getting this hands on learning
                experience has been super helpful.
            </p>
            <br>
            <br>
            <h2>Plan</h2>
            <p>
                For the next deadline, I plan to focus on the following things:
            <ul>
                <li>
                    Set up the explore page– allow users to search for courses, subjects, course codes, and users
                </li>
                <li>
                    Set up log in and sign up pages
                </li>
                <li>
                    Set up rough path for guest / user / administrator pages
                </li>
                <li>
                    Finalize connecting pages to the database– including User page to edit profile and log in / out
                </li>
                <li>
                    Test all features with synthetic data loaded into Firestore
                </li>
            </ul>
            </p>
            <br>
            <br>
            <h2>Summary</h2>
            <p>
                So far, I’m proud of the progress I’ve made. This week I spent a lot of time on my project, but I made a
                lot of progress and am happy to connect to the database and be working with real data (rather than hard
                coded copies). I’m a little concerned about certain requirements, including testing and roles, that we
                haven’t talked about much in class. I will continue to work to get everything else done, so that I have
                enough time for this at the end.
            </p>
            <br>
            <br>
        </div>

        <footer>
            <!-- Copy and pasted via Create Commons Lisence (as specified on coursepage)-->
            <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">
                <img alt="Creative Commons License" style="border-width:0"
                    src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a>
            <br />
            <div class="credit">
                This work is licensed under a
                <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">
                    Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.
                </a>
                <br>
                All photos and wireframes were created by me, Abby Mapes.
            </div>
        </footer>
    </div>
</body>

</html>